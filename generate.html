<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Generate Recipes</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 0;
      padding: 0;
      background-color: #f0f0f0;
      display: flex;
      justify-content: center;
      align-items: center;
      min-height: 100vh;
    }
    .container {
      width: 90%;
      max-width: 600px;
      background-color: white;
      padding: 20px;
      border-radius: 10px;
      box-shadow: 0px 4px 10px rgba(0,0,0,0.1);
    }
    h1 {
      color: #333;
    }
    ul {
      list-style-type: none;
      padding-left: 0;
    }
    li {
      margin-bottom: 10px;
    }
    .btn {
      display: inline-block;
      padding: 10px 20px;
      background-color: #ff8e61;
      color: white;
      text-align: center;
      border-radius: 5px;
      text-decoration: none;
      font-weight: bold;
    }
    .btn:hover {
      background-color: #ff7300;
    }
    .reset-btn {
      background-color: #d9534f; /* Red for reset */
    }
    .reset-btn:hover {
      background-color: #c9302c; /* Darker red on hover */
    }
  </style>
</head>
<body>
<div class="container">
  <h1>Recipes Based on Your Ingredients</h1>
  <ul id="recipe-list"></ul>

  <div style="margin-top: 20px;">
    <a href="index.html" class="btn">Start Over</a>
    <button class="btn reset-btn" onclick="resetList()">Reset List</button>
  </div>
</div>

<script>
  // Example recipe dictionary
  const recipesDB = {
    orange: ["Orange Juice", "Orange Cake", "Orange Salad"],
    banana: ["Banana Bread", "Banana Smoothie", "Banana Pancakes"],
    apple:  ["Apple Pie", "Apple Crumble", "Apple Smoothie"],
    carrot: ["Carrot Soup", "Carrot Cake", "Carrot Salad"],
    pizza:  ["Homemade Pizza", "Pizza Rolls"],
    "hot dog": ["Hot Dog Classic", "Chili Dog"],
    donut: ["Glazed Donut", "Chocolate Donut"],
    cake: ["Vanilla Cake", "Chocolate Cake"]
  };

  // Load the final confirmed ingredients
  const confirmedIngredients = JSON.parse(localStorage.getItem("confirmedIngredients")) || [];
  
  // Optionally load the user's other preferences
  const allergies = localStorage.getItem("allergies") || "";
  const portion   = localStorage.getItem("portion")   || "1";
  const prefs     = localStorage.getItem("preferences") || "";

  console.log("User allergies:", allergies);
  console.log("Portion size:", portion);
  console.log("Other prefs:", prefs);

  const recipeList = document.getElementById("recipe-list");

  if (confirmedIngredients.length > 0) {
    confirmedIngredients.forEach(item => {
      // item.name = e.g. "Banana", item.count = e.g. 2
      const lowerCaseName = item.name.toLowerCase();
      const possibleRecipes = recipesDB[lowerCaseName] || ["No known recipes for this item"];

      const li = document.createElement("li");
      li.innerHTML = `<strong>${item.name} (x${item.count}):</strong> 
                      ${possibleRecipes.join(", ")}`;
      recipeList.appendChild(li);
    });
  } else {
    recipeList.innerHTML = "<li>No confirmed ingredients found. Please go back and scan.</li>";
  }

  // Reset function if user wants to clear everything
  function resetList() {
    if (confirm("Are you sure you want to reset everything?")) {
      localStorage.removeItem("detectedIngredients");
      localStorage.removeItem("confirmedIngredients");
      localStorage.removeItem("allergies");
      localStorage.removeItem("portion");
      localStorage.removeItem("preferences");
      alert("All data has been reset.");
      location.reload();
    }
  }
</script>
</body>
</html>
